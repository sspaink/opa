{
	"cases": [
		{
			"note": "ir/call_dynamic in comprehension",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\np := x if {\n\tb := input\n\tx := {y | y := data.a[b][_]}\n}\n",
				"package a\n\nb := {\"foo\", \"bar\"}\n",
				"package a\n\nc := {\"x\", \"y\"}\n"
			],
			"input": "b",
			"want_result": [
				{
					"x": [
						"bar",
						"foo"
					]
				}
			],
			"sort_bindings": true,
			"ignore_generated_vars": false,
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "g0"
						},
						{
							"value": "a"
						},
						{
							"value": "bar"
						},
						{
							"value": "foo"
						},
						{
							"value": "y"
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "module-1.rego"
						},
						{
							"value": "module-2.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 3,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 3,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 3,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 3,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 3,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.a.b",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "string_index",
													"value": 3
												},
												"set": 4,
												"file": 1,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "string_index",
													"value": 4
												},
												"set": 4,
												"file": 1,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 1,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 1,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 1,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"a",
								"b"
							]
						},
						{
							"name": "g0.data.a.c",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 2,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 4,
												"file": 2,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "string_index",
													"value": 0
												},
												"set": 4,
												"file": 2,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "string_index",
													"value": 5
												},
												"set": 4,
												"file": 2,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 2,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 2,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 2,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 2,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"a",
								"c"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 0,
												"file": 0,
												"col": 2,
												"row": 4
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 0
												},
												"target": 4,
												"file": 0,
												"col": 2,
												"row": 4
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 7,
												"row": 5
											}
										},
										{
											"type": "BlockStmt",
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"type": "BlockStmt",
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"type": "BlockStmt",
																					"stmt": {
																						"blocks": [
																							{
																								"stmts": [
																									{
																										"type": "BlockStmt",
																										"stmt": {
																											"blocks": [
																												{
																													"stmts": [
																														{
																															"type": "CallDynamicStmt",
																															"stmt": {
																																"args": [
																																	0,
																																	1
																																],
																																"result": 6,
																																"path": [
																																	{
																																		"type": "string_index",
																																		"value": 1
																																	},
																																	{
																																		"type": "string_index",
																																		"value": 2
																																	},
																																	{
																																		"type": "local",
																																		"value": 4
																																	}
																																],
																																"file": 0,
																																"col": 12,
																																"row": 5
																															}
																														},
																														{
																															"type": "BreakStmt",
																															"stmt": {
																																"index": 1,
																																"file": 0,
																																"col": 12,
																																"row": 5
																															}
																														}
																													]
																												},
																												{
																													"stmts": [
																														{
																															"type": "DotStmt",
																															"stmt": {
																																"source": {
																																	"type": "local",
																																	"value": 1
																																},
																																"key": {
																																	"type": "string_index",
																																	"value": 2
																																},
																																"target": 7,
																																"file": 0,
																																"col": 12,
																																"row": 5
																															}
																														},
																														{
																															"type": "DotStmt",
																															"stmt": {
																																"source": {
																																	"type": "local",
																																	"value": 7
																																},
																																"key": {
																																	"type": "local",
																																	"value": 4
																																},
																																"target": 8,
																																"file": 0,
																																"col": 12,
																																"row": 5
																															}
																														},
																														{
																															"type": "AssignVarStmt",
																															"stmt": {
																																"source": {
																																	"type": "local",
																																	"value": 8
																																},
																																"target": 6,
																																"file": 0,
																																"col": 12,
																																"row": 5
																															}
																														},
																														{
																															"type": "BreakStmt",
																															"stmt": {
																																"index": 1,
																																"file": 0,
																																"col": 12,
																																"row": 5
																															}
																														}
																													]
																												}
																											],
																											"file": 0,
																											"col": 0,
																											"row": 0
																										}
																									},
																									{
																										"type": "BreakStmt",
																										"stmt": {
																											"index": 2,
																											"file": 0,
																											"col": 0,
																											"row": 0
																										}
																									}
																								]
																							}
																						],
																						"file": 0,
																						"col": 0,
																						"row": 0
																					}
																				},
																				{
																					"type": "ScanStmt",
																					"stmt": {
																						"source": 6,
																						"key": 9,
																						"value": 10,
																						"block": {
																							"stmts": [
																								{
																									"type": "AssignVarStmt",
																									"stmt": {
																										"source": {
																											"type": "local",
																											"value": 9
																										},
																										"target": 11,
																										"file": 0,
																										"col": 12,
																										"row": 5
																									}
																								},
																								{
																									"type": "AssignVarStmt",
																									"stmt": {
																										"source": {
																											"type": "local",
																											"value": 10
																										},
																										"target": 12,
																										"file": 0,
																										"col": 12,
																										"row": 5
																									}
																								},
																								{
																									"type": "SetAddStmt",
																									"stmt": {
																										"value": {
																											"type": "local",
																											"value": 12
																										},
																										"set": 5,
																										"file": 0,
																										"col": 7,
																										"row": 5
																									}
																								}
																							]
																						},
																						"file": 0,
																						"col": 12,
																						"row": 5
																					}
																				}
																			]
																		}
																	],
																	"file": 0,
																	"col": 12,
																	"row": 5
																}
															}
														]
													}
												],
												"file": 0,
												"col": 7,
												"row": 5
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 5
												},
												"target": 13,
												"file": 0,
												"col": 7,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 13
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": [
						"bar",
						"foo"
					]
				}
			]
		},
		{
			"note": "ir/no call-dynamic with mixed partial rules",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\np := data.a.b[c] if c := \"c\"\n",
				"package a\n\nb[c] := \"C\" if c := \"c\"\n\nb[\"d\"] := \"D\"\n"
			],
			"want_result": [
				{
					"x": "C"
				}
			],
			"ignore_generated_vars": false,
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "c"
						},
						{
							"value": "C"
						},
						{
							"value": "D"
						},
						{
							"value": "d"
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "module-1.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 2,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 2,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 2,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 2,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 2,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.a.b",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 2,
												"file": 1,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 1
												},
												"target": 4,
												"file": 1,
												"col": 16,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertOnceStmt",
											"stmt": {
												"key": {
													"type": "local",
													"value": 4
												},
												"value": {
													"type": "string_index",
													"value": 2
												},
												"object": 2,
												"file": 1,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertOnceStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 4
												},
												"value": {
													"type": "string_index",
													"value": 3
												},
												"object": 2,
												"file": 1,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 1,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"a",
								"b"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 1
												},
												"target": 4,
												"file": 0,
												"col": 21,
												"row": 3
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.a.b",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 5,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "DotStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 5
												},
												"key": {
													"type": "local",
													"value": 4
												},
												"target": 6,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 7
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": "C"
				}
			]
		},
		{
			"note": "ir/call-dynamic with mixed partial rules",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\np := a[b].c if b := \"b\"\n\na.b.c := \"C\"\n\na.x.d := \"D\"\n"
			],
			"want_result": [
				{
					"x": "C"
				}
			],
			"ignore_generated_vars": false,
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "b"
						},
						{
							"value": "g0"
						},
						{
							"value": "test"
						},
						{
							"value": "a"
						},
						{
							"value": "c"
						},
						{
							"value": "C"
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.a.b.c",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 6
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"a",
								"b",
								"c"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 1
												},
												"target": 4,
												"file": 0,
												"col": 16,
												"row": 3
											}
										},
										{
											"type": "BlockStmt",
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"type": "BlockStmt",
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"type": "BlockStmt",
																					"stmt": {
																						"blocks": [
																							{
																								"stmts": [
																									{
																										"type": "CallDynamicStmt",
																										"stmt": {
																											"args": [
																												0,
																												1
																											],
																											"result": 5,
																											"path": [
																												{
																													"type": "string_index",
																													"value": 2
																												},
																												{
																													"type": "string_index",
																													"value": 3
																												},
																												{
																													"type": "string_index",
																													"value": 4
																												},
																												{
																													"type": "local",
																													"value": 4
																												},
																												{
																													"type": "string_index",
																													"value": 5
																												}
																											],
																											"file": 0,
																											"col": 6,
																											"row": 3
																										}
																									},
																									{
																										"type": "BreakStmt",
																										"stmt": {
																											"index": 1,
																											"file": 0,
																											"col": 6,
																											"row": 3
																										}
																									}
																								]
																							},
																							{
																								"stmts": [
																									{
																										"type": "DotStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 1
																											},
																											"key": {
																												"type": "string_index",
																												"value": 3
																											},
																											"target": 6,
																											"file": 0,
																											"col": 6,
																											"row": 3
																										}
																									},
																									{
																										"type": "DotStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 6
																											},
																											"key": {
																												"type": "string_index",
																												"value": 4
																											},
																											"target": 7,
																											"file": 0,
																											"col": 6,
																											"row": 3
																										}
																									},
																									{
																										"type": "DotStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 7
																											},
																											"key": {
																												"type": "local",
																												"value": 4
																											},
																											"target": 8,
																											"file": 0,
																											"col": 6,
																											"row": 3
																										}
																									},
																									{
																										"type": "DotStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 8
																											},
																											"key": {
																												"type": "string_index",
																												"value": 5
																											},
																											"target": 9,
																											"file": 0,
																											"col": 6,
																											"row": 3
																										}
																									},
																									{
																										"type": "AssignVarStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 9
																											},
																											"target": 5,
																											"file": 0,
																											"col": 6,
																											"row": 3
																										}
																									},
																									{
																										"type": "BreakStmt",
																										"stmt": {
																											"index": 1,
																											"file": 0,
																											"col": 6,
																											"row": 3
																										}
																									}
																								]
																							}
																						],
																						"file": 0,
																						"col": 0,
																						"row": 0
																					}
																				},
																				{
																					"type": "BreakStmt",
																					"stmt": {
																						"index": 2,
																						"file": 0,
																						"col": 0,
																						"row": 0
																					}
																				}
																			]
																		}
																	],
																	"file": 0,
																	"col": 0,
																	"row": 0
																}
															},
															{
																"type": "AssignVarStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 5
																	},
																	"target": 10,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "AssignVarOnceStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 10
																	},
																	"target": 3,
																	"file": 0,
																	"col": 1,
																	"row": 3
																}
															}
														]
													}
												],
												"file": 0,
												"col": 6,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": "C"
				}
			]
		},
		{
			"note": "ir/no call-dynamic with mixed partial rules, ref heads",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\np := a.b[c] if c := \"c\"\n\na.b[c] := \"C\" if c := \"c\"\n\na.b.d := \"D\"\n"
			],
			"want_result": [
				{
					"x": "C"
				}
			],
			"ignore_generated_vars": false,
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "c"
						},
						{
							"value": "C"
						},
						{
							"value": "D"
						},
						{
							"value": "d"
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.a.b",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 1
												},
												"target": 4,
												"file": 0,
												"col": 18,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertOnceStmt",
											"stmt": {
												"key": {
													"type": "local",
													"value": 4
												},
												"value": {
													"type": "string_index",
													"value": 2
												},
												"object": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertOnceStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 4
												},
												"value": {
													"type": "string_index",
													"value": 3
												},
												"object": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"a",
								"b"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 1
												},
												"target": 4,
												"file": 0,
												"col": 16,
												"row": 3
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.a.b",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 5,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "DotStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 5
												},
												"key": {
													"type": "local",
													"value": 4
												},
												"target": 6,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 7
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": "C"
				}
			]
		},
		{
			"note": "ir/call-dynamic with mixed partial rules, ref heads",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\np := a[b][c] if {\n\tb := \"b\"\n\tc := \"c\"\n}\n\na.b.c := \"C\"\n\na.x.d := \"D\"\n"
			],
			"want_result": [
				{
					"x": "C"
				}
			],
			"ignore_generated_vars": false,
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "b"
						},
						{
							"value": "c"
						},
						{
							"value": "g0"
						},
						{
							"value": "test"
						},
						{
							"value": "a"
						},
						{
							"value": "C"
						},
						{
							"value": "D"
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.a.b.c",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 8
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 6
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 8
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 8
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 8
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 8
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"a",
								"b",
								"c"
							]
						},
						{
							"name": "g0.data.test.a.x.d",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 10
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 7
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 10
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 10
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 10
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 10
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"a",
								"x",
								"d"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 1
												},
												"target": 4,
												"file": 0,
												"col": 2,
												"row": 4
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 2
												},
												"target": 5,
												"file": 0,
												"col": 2,
												"row": 5
											}
										},
										{
											"type": "BlockStmt",
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"type": "BlockStmt",
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"type": "BlockStmt",
																					"stmt": {
																						"blocks": [
																							{
																								"stmts": [
																									{
																										"type": "CallDynamicStmt",
																										"stmt": {
																											"args": [
																												0,
																												1
																											],
																											"result": 6,
																											"path": [
																												{
																													"type": "string_index",
																													"value": 3
																												},
																												{
																													"type": "string_index",
																													"value": 4
																												},
																												{
																													"type": "string_index",
																													"value": 5
																												},
																												{
																													"type": "local",
																													"value": 4
																												},
																												{
																													"type": "local",
																													"value": 5
																												}
																											],
																											"file": 0,
																											"col": 6,
																											"row": 3
																										}
																									},
																									{
																										"type": "BreakStmt",
																										"stmt": {
																											"index": 1,
																											"file": 0,
																											"col": 6,
																											"row": 3
																										}
																									}
																								]
																							},
																							{
																								"stmts": [
																									{
																										"type": "DotStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 1
																											},
																											"key": {
																												"type": "string_index",
																												"value": 4
																											},
																											"target": 7,
																											"file": 0,
																											"col": 6,
																											"row": 3
																										}
																									},
																									{
																										"type": "DotStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 7
																											},
																											"key": {
																												"type": "string_index",
																												"value": 5
																											},
																											"target": 8,
																											"file": 0,
																											"col": 6,
																											"row": 3
																										}
																									},
																									{
																										"type": "DotStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 8
																											},
																											"key": {
																												"type": "local",
																												"value": 4
																											},
																											"target": 9,
																											"file": 0,
																											"col": 6,
																											"row": 3
																										}
																									},
																									{
																										"type": "DotStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 9
																											},
																											"key": {
																												"type": "local",
																												"value": 5
																											},
																											"target": 10,
																											"file": 0,
																											"col": 6,
																											"row": 3
																										}
																									},
																									{
																										"type": "AssignVarStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 10
																											},
																											"target": 6,
																											"file": 0,
																											"col": 6,
																											"row": 3
																										}
																									},
																									{
																										"type": "BreakStmt",
																										"stmt": {
																											"index": 1,
																											"file": 0,
																											"col": 6,
																											"row": 3
																										}
																									}
																								]
																							}
																						],
																						"file": 0,
																						"col": 0,
																						"row": 0
																					}
																				},
																				{
																					"type": "BreakStmt",
																					"stmt": {
																						"index": 2,
																						"file": 0,
																						"col": 0,
																						"row": 0
																					}
																				}
																			]
																		}
																	],
																	"file": 0,
																	"col": 0,
																	"row": 0
																}
															},
															{
																"type": "AssignVarStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 6
																	},
																	"target": 11,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "AssignVarOnceStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 11
																	},
																	"target": 3,
																	"file": 0,
																	"col": 1,
																	"row": 3
																}
															}
														]
													}
												],
												"file": 0,
												"col": 6,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": "C"
				}
			]
		},
		{
			"note": "ir/call-dynamic with ref heads, issue 5839",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\np := a[b][c].allow if {\n\tb := \"b\"\n\tc := \"c\"\n}\n\na.b.c.allow := true\n\na.x.d.allow := true\n\na.y[x] := \"E\" if x := \"x\"\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"ignore_generated_vars": false,
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "b"
						},
						{
							"value": "c"
						},
						{
							"value": "test"
						},
						{
							"value": "a"
						},
						{
							"value": "allow"
						},
						{
							"value": "d"
						},
						{
							"value": "y"
						},
						{
							"value": "E"
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.a.b.c.allow",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 8
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 8
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 8
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 8
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 8
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"a",
								"b",
								"c",
								"allow"
							]
						},
						{
							"name": "g0.data.test.a.x.d.allow",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 10
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 10
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 10
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 10
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 10
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"a",
								"x",
								"d",
								"allow"
							]
						},
						{
							"name": "g0.data.test.a.y",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 12
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 0
												},
												"target": 4,
												"file": 0,
												"col": 18,
												"row": 12
											}
										},
										{
											"type": "ObjectInsertOnceStmt",
											"stmt": {
												"key": {
													"type": "local",
													"value": 4
												},
												"value": {
													"type": "string_index",
													"value": 8
												},
												"object": 2,
												"file": 0,
												"col": 1,
												"row": 12
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 12
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"a",
								"y"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 1
												},
												"target": 4,
												"file": 0,
												"col": 2,
												"row": 4
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 2
												},
												"target": 5,
												"file": 0,
												"col": 2,
												"row": 5
											}
										},
										{
											"type": "BlockStmt",
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"type": "EqualStmt",
																"stmt": {
																	"a": {
																		"type": "string_index",
																		"value": 1
																	},
																	"b": {
																		"type": "local",
																		"value": 4
																	},
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "BlockStmt",
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"type": "EqualStmt",
																					"stmt": {
																						"a": {
																							"type": "string_index",
																							"value": 2
																						},
																						"b": {
																							"type": "local",
																							"value": 5
																						},
																						"file": 0,
																						"col": 6,
																						"row": 3
																					}
																				},
																				{
																					"type": "CallStmt",
																					"stmt": {
																						"func": "g0.data.test.a.b.c.allow",
																						"args": [
																							{
																								"type": "local",
																								"value": 0
																							},
																							{
																								"type": "local",
																								"value": 1
																							}
																						],
																						"result": 6,
																						"file": 0,
																						"col": 6,
																						"row": 3
																					}
																				},
																				{
																					"type": "AssignVarStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 6
																						},
																						"target": 7,
																						"file": 0,
																						"col": 6,
																						"row": 3
																					}
																				},
																				{
																					"type": "AssignVarOnceStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 7
																						},
																						"target": 3,
																						"file": 0,
																						"col": 1,
																						"row": 3
																					}
																				}
																			]
																		}
																	],
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "MakeSetStmt",
																"stmt": {
																	"target": 8,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "SetAddStmt",
																"stmt": {
																	"value": {
																		"type": "string_index",
																		"value": 2
																	},
																	"set": 8,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 1
																	},
																	"key": {
																		"type": "string_index",
																		"value": 3
																	},
																	"target": 9,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 9
																	},
																	"key": {
																		"type": "string_index",
																		"value": 4
																	},
																	"target": 10,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 10
																	},
																	"key": {
																		"type": "string_index",
																		"value": 1
																	},
																	"target": 11,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "ScanStmt",
																"stmt": {
																	"source": 11,
																	"key": 12,
																	"value": 13,
																	"block": {
																		"stmts": [
																			{
																				"type": "EqualStmt",
																				"stmt": {
																					"a": {
																						"type": "local",
																						"value": 12
																					},
																					"b": {
																						"type": "local",
																						"value": 5
																					},
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "NotStmt",
																				"stmt": {
																					"block": {
																						"stmts": [
																							{
																								"type": "DotStmt",
																								"stmt": {
																									"source": {
																										"type": "local",
																										"value": 8
																									},
																									"key": {
																										"type": "local",
																										"value": 12
																									},
																									"target": 14,
																									"file": 0,
																									"col": 6,
																									"row": 3
																								}
																							}
																						]
																					},
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "BlockStmt",
																				"stmt": {
																					"blocks": [
																						{
																							"stmts": [
																								{
																									"type": "BlockStmt",
																									"stmt": {
																										"blocks": [
																											{
																												"stmts": [
																													{
																														"type": "DotStmt",
																														"stmt": {
																															"source": {
																																"type": "local",
																																"value": 13
																															},
																															"key": {
																																"type": "string_index",
																																"value": 5
																															},
																															"target": 17,
																															"file": 0,
																															"col": 6,
																															"row": 3
																														}
																													},
																													{
																														"type": "BreakStmt",
																														"stmt": {
																															"index": 1,
																															"file": 0,
																															"col": 6,
																															"row": 3
																														}
																													}
																												]
																											}
																										],
																										"file": 0,
																										"col": 6,
																										"row": 3
																									}
																								},
																								{
																									"type": "BreakStmt",
																									"stmt": {
																										"index": 1,
																										"file": 0,
																										"col": 6,
																										"row": 3
																									}
																								}
																							]
																						}
																					],
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "AssignVarStmt",
																				"stmt": {
																					"source": {
																						"type": "local",
																						"value": 17
																					},
																					"target": 18,
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "AssignVarOnceStmt",
																				"stmt": {
																					"source": {
																						"type": "local",
																						"value": 18
																					},
																					"target": 3,
																					"file": 0,
																					"col": 1,
																					"row": 3
																				}
																			}
																		]
																	},
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															}
														]
													},
													{
														"stmts": [
															{
																"type": "EqualStmt",
																"stmt": {
																	"a": {
																		"type": "string_index",
																		"value": 0
																	},
																	"b": {
																		"type": "local",
																		"value": 4
																	},
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "BlockStmt",
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"type": "EqualStmt",
																					"stmt": {
																						"a": {
																							"type": "string_index",
																							"value": 6
																						},
																						"b": {
																							"type": "local",
																							"value": 5
																						},
																						"file": 0,
																						"col": 6,
																						"row": 3
																					}
																				},
																				{
																					"type": "CallStmt",
																					"stmt": {
																						"func": "g0.data.test.a.x.d.allow",
																						"args": [
																							{
																								"type": "local",
																								"value": 0
																							},
																							{
																								"type": "local",
																								"value": 1
																							}
																						],
																						"result": 19,
																						"file": 0,
																						"col": 6,
																						"row": 3
																					}
																				},
																				{
																					"type": "AssignVarStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 19
																						},
																						"target": 20,
																						"file": 0,
																						"col": 6,
																						"row": 3
																					}
																				},
																				{
																					"type": "AssignVarOnceStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 20
																						},
																						"target": 3,
																						"file": 0,
																						"col": 1,
																						"row": 3
																					}
																				}
																			]
																		}
																	],
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "MakeSetStmt",
																"stmt": {
																	"target": 21,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "SetAddStmt",
																"stmt": {
																	"value": {
																		"type": "string_index",
																		"value": 6
																	},
																	"set": 21,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 1
																	},
																	"key": {
																		"type": "string_index",
																		"value": 3
																	},
																	"target": 22,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 22
																	},
																	"key": {
																		"type": "string_index",
																		"value": 4
																	},
																	"target": 23,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 23
																	},
																	"key": {
																		"type": "string_index",
																		"value": 0
																	},
																	"target": 24,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "ScanStmt",
																"stmt": {
																	"source": 24,
																	"key": 25,
																	"value": 26,
																	"block": {
																		"stmts": [
																			{
																				"type": "EqualStmt",
																				"stmt": {
																					"a": {
																						"type": "local",
																						"value": 25
																					},
																					"b": {
																						"type": "local",
																						"value": 5
																					},
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "NotStmt",
																				"stmt": {
																					"block": {
																						"stmts": [
																							{
																								"type": "DotStmt",
																								"stmt": {
																									"source": {
																										"type": "local",
																										"value": 21
																									},
																									"key": {
																										"type": "local",
																										"value": 25
																									},
																									"target": 27,
																									"file": 0,
																									"col": 6,
																									"row": 3
																								}
																							}
																						]
																					},
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "BlockStmt",
																				"stmt": {
																					"blocks": [
																						{
																							"stmts": [
																								{
																									"type": "BlockStmt",
																									"stmt": {
																										"blocks": [
																											{
																												"stmts": [
																													{
																														"type": "DotStmt",
																														"stmt": {
																															"source": {
																																"type": "local",
																																"value": 26
																															},
																															"key": {
																																"type": "string_index",
																																"value": 5
																															},
																															"target": 30,
																															"file": 0,
																															"col": 6,
																															"row": 3
																														}
																													},
																													{
																														"type": "BreakStmt",
																														"stmt": {
																															"index": 1,
																															"file": 0,
																															"col": 6,
																															"row": 3
																														}
																													}
																												]
																											}
																										],
																										"file": 0,
																										"col": 6,
																										"row": 3
																									}
																								},
																								{
																									"type": "BreakStmt",
																									"stmt": {
																										"index": 1,
																										"file": 0,
																										"col": 6,
																										"row": 3
																									}
																								}
																							]
																						}
																					],
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "AssignVarStmt",
																				"stmt": {
																					"source": {
																						"type": "local",
																						"value": 30
																					},
																					"target": 31,
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "AssignVarOnceStmt",
																				"stmt": {
																					"source": {
																						"type": "local",
																						"value": 31
																					},
																					"target": 3,
																					"file": 0,
																					"col": 1,
																					"row": 3
																				}
																			}
																		]
																	},
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															}
														]
													},
													{
														"stmts": [
															{
																"type": "EqualStmt",
																"stmt": {
																	"a": {
																		"type": "string_index",
																		"value": 7
																	},
																	"b": {
																		"type": "local",
																		"value": 4
																	},
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "CallStmt",
																"stmt": {
																	"func": "g0.data.test.a.y",
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"result": 32,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 32
																	},
																	"key": {
																		"type": "local",
																		"value": 5
																	},
																	"target": 33,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 33
																	},
																	"key": {
																		"type": "string_index",
																		"value": 5
																	},
																	"target": 34,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "AssignVarStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 34
																	},
																	"target": 35,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "AssignVarOnceStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 35
																	},
																	"target": 3,
																	"file": 0,
																	"col": 1,
																	"row": 3
																}
															}
														]
													}
												],
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 36,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "string_index",
													"value": 1
												},
												"set": 36,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "string_index",
													"value": 0
												},
												"set": 36,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "string_index",
													"value": 7
												},
												"set": 36,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "DotStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 1
												},
												"key": {
													"type": "string_index",
													"value": 3
												},
												"target": 37,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "DotStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 37
												},
												"key": {
													"type": "string_index",
													"value": 4
												},
												"target": 38,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "ScanStmt",
											"stmt": {
												"source": 38,
												"key": 39,
												"value": 40,
												"block": {
													"stmts": [
														{
															"type": "EqualStmt",
															"stmt": {
																"a": {
																	"type": "local",
																	"value": 39
																},
																"b": {
																	"type": "local",
																	"value": 4
																},
																"file": 0,
																"col": 6,
																"row": 3
															}
														},
														{
															"type": "NotStmt",
															"stmt": {
																"block": {
																	"stmts": [
																		{
																			"type": "DotStmt",
																			"stmt": {
																				"source": {
																					"type": "local",
																					"value": 36
																				},
																				"key": {
																					"type": "local",
																					"value": 39
																				},
																				"target": 41,
																				"file": 0,
																				"col": 6,
																				"row": 3
																			}
																		}
																	]
																},
																"file": 0,
																"col": 6,
																"row": 3
															}
														},
														{
															"type": "DotStmt",
															"stmt": {
																"source": {
																	"type": "local",
																	"value": 40
																},
																"key": {
																	"type": "local",
																	"value": 5
																},
																"target": 42,
																"file": 0,
																"col": 6,
																"row": 3
															}
														},
														{
															"type": "BlockStmt",
															"stmt": {
																"blocks": [
																	{
																		"stmts": [
																			{
																				"type": "BlockStmt",
																				"stmt": {
																					"blocks": [
																						{
																							"stmts": [
																								{
																									"type": "DotStmt",
																									"stmt": {
																										"source": {
																											"type": "local",
																											"value": 42
																										},
																										"key": {
																											"type": "string_index",
																											"value": 5
																										},
																										"target": 45,
																										"file": 0,
																										"col": 6,
																										"row": 3
																									}
																								},
																								{
																									"type": "BreakStmt",
																									"stmt": {
																										"index": 1,
																										"file": 0,
																										"col": 6,
																										"row": 3
																									}
																								}
																							]
																						}
																					],
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "BreakStmt",
																				"stmt": {
																					"index": 1,
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			}
																		]
																	}
																],
																"file": 0,
																"col": 6,
																"row": 3
															}
														},
														{
															"type": "AssignVarStmt",
															"stmt": {
																"source": {
																	"type": "local",
																	"value": 45
																},
																"target": 46,
																"file": 0,
																"col": 6,
																"row": 3
															}
														},
														{
															"type": "AssignVarOnceStmt",
															"stmt": {
																"source": {
																	"type": "local",
																	"value": 46
																},
																"target": 3,
																"file": 0,
																"col": 1,
																"row": 3
															}
														}
													]
												},
												"file": 0,
												"col": 6,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		},
		{
			"note": "ir/call-dynamic with ref heads, issue 5839, penultimate",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\np := a[b][c] if {\n\tb := \"b\"\n\tc := \"c\"\n}\n\na.b.c := true\n\na.x.d := true\n\na.y := \"E\"\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"ignore_generated_vars": false,
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "b"
						},
						{
							"value": "c"
						},
						{
							"value": "test"
						},
						{
							"value": "a"
						},
						{
							"value": "d"
						},
						{
							"value": "y"
						},
						{
							"value": "E"
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.a.b.c",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 8
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 8
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 8
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 8
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 8
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"a",
								"b",
								"c"
							]
						},
						{
							"name": "g0.data.test.a.x.d",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 10
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 10
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 10
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 10
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 10
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"a",
								"x",
								"d"
							]
						},
						{
							"name": "g0.data.test.a.y",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 7
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 12
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 12
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 12
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"a",
								"y"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 1
												},
												"target": 4,
												"file": 0,
												"col": 2,
												"row": 4
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 2
												},
												"target": 5,
												"file": 0,
												"col": 2,
												"row": 5
											}
										},
										{
											"type": "BlockStmt",
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"type": "EqualStmt",
																"stmt": {
																	"a": {
																		"type": "string_index",
																		"value": 1
																	},
																	"b": {
																		"type": "local",
																		"value": 4
																	},
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "BlockStmt",
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"type": "EqualStmt",
																					"stmt": {
																						"a": {
																							"type": "string_index",
																							"value": 2
																						},
																						"b": {
																							"type": "local",
																							"value": 5
																						},
																						"file": 0,
																						"col": 6,
																						"row": 3
																					}
																				},
																				{
																					"type": "CallStmt",
																					"stmt": {
																						"func": "g0.data.test.a.b.c",
																						"args": [
																							{
																								"type": "local",
																								"value": 0
																							},
																							{
																								"type": "local",
																								"value": 1
																							}
																						],
																						"result": 6,
																						"file": 0,
																						"col": 6,
																						"row": 3
																					}
																				},
																				{
																					"type": "AssignVarStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 6
																						},
																						"target": 7,
																						"file": 0,
																						"col": 6,
																						"row": 3
																					}
																				},
																				{
																					"type": "AssignVarOnceStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 7
																						},
																						"target": 3,
																						"file": 0,
																						"col": 1,
																						"row": 3
																					}
																				}
																			]
																		}
																	],
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "MakeSetStmt",
																"stmt": {
																	"target": 8,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "SetAddStmt",
																"stmt": {
																	"value": {
																		"type": "string_index",
																		"value": 2
																	},
																	"set": 8,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 1
																	},
																	"key": {
																		"type": "string_index",
																		"value": 3
																	},
																	"target": 9,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 9
																	},
																	"key": {
																		"type": "string_index",
																		"value": 4
																	},
																	"target": 10,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 10
																	},
																	"key": {
																		"type": "string_index",
																		"value": 1
																	},
																	"target": 11,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "ScanStmt",
																"stmt": {
																	"source": 11,
																	"key": 12,
																	"value": 13,
																	"block": {
																		"stmts": [
																			{
																				"type": "EqualStmt",
																				"stmt": {
																					"a": {
																						"type": "local",
																						"value": 12
																					},
																					"b": {
																						"type": "local",
																						"value": 5
																					},
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "NotStmt",
																				"stmt": {
																					"block": {
																						"stmts": [
																							{
																								"type": "DotStmt",
																								"stmt": {
																									"source": {
																										"type": "local",
																										"value": 8
																									},
																									"key": {
																										"type": "local",
																										"value": 12
																									},
																									"target": 14,
																									"file": 0,
																									"col": 6,
																									"row": 3
																								}
																							}
																						]
																					},
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "BlockStmt",
																				"stmt": {
																					"blocks": [
																						{
																							"stmts": [
																								{
																									"type": "BlockStmt",
																									"stmt": {
																										"blocks": [
																											{
																												"stmts": [
																													{
																														"type": "BreakStmt",
																														"stmt": {
																															"index": 1,
																															"file": 0,
																															"col": 6,
																															"row": 3
																														}
																													}
																												]
																											}
																										],
																										"file": 0,
																										"col": 6,
																										"row": 3
																									}
																								},
																								{
																									"type": "BreakStmt",
																									"stmt": {
																										"index": 1,
																										"file": 0,
																										"col": 6,
																										"row": 3
																									}
																								}
																							]
																						}
																					],
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "AssignVarStmt",
																				"stmt": {
																					"source": {
																						"type": "local",
																						"value": 13
																					},
																					"target": 17,
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "AssignVarOnceStmt",
																				"stmt": {
																					"source": {
																						"type": "local",
																						"value": 17
																					},
																					"target": 3,
																					"file": 0,
																					"col": 1,
																					"row": 3
																				}
																			}
																		]
																	},
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															}
														]
													},
													{
														"stmts": [
															{
																"type": "EqualStmt",
																"stmt": {
																	"a": {
																		"type": "string_index",
																		"value": 0
																	},
																	"b": {
																		"type": "local",
																		"value": 4
																	},
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "BlockStmt",
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"type": "EqualStmt",
																					"stmt": {
																						"a": {
																							"type": "string_index",
																							"value": 5
																						},
																						"b": {
																							"type": "local",
																							"value": 5
																						},
																						"file": 0,
																						"col": 6,
																						"row": 3
																					}
																				},
																				{
																					"type": "CallStmt",
																					"stmt": {
																						"func": "g0.data.test.a.x.d",
																						"args": [
																							{
																								"type": "local",
																								"value": 0
																							},
																							{
																								"type": "local",
																								"value": 1
																							}
																						],
																						"result": 18,
																						"file": 0,
																						"col": 6,
																						"row": 3
																					}
																				},
																				{
																					"type": "AssignVarStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 18
																						},
																						"target": 19,
																						"file": 0,
																						"col": 6,
																						"row": 3
																					}
																				},
																				{
																					"type": "AssignVarOnceStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 19
																						},
																						"target": 3,
																						"file": 0,
																						"col": 1,
																						"row": 3
																					}
																				}
																			]
																		}
																	],
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "MakeSetStmt",
																"stmt": {
																	"target": 20,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "SetAddStmt",
																"stmt": {
																	"value": {
																		"type": "string_index",
																		"value": 5
																	},
																	"set": 20,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 1
																	},
																	"key": {
																		"type": "string_index",
																		"value": 3
																	},
																	"target": 21,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 21
																	},
																	"key": {
																		"type": "string_index",
																		"value": 4
																	},
																	"target": 22,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 22
																	},
																	"key": {
																		"type": "string_index",
																		"value": 0
																	},
																	"target": 23,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "ScanStmt",
																"stmt": {
																	"source": 23,
																	"key": 24,
																	"value": 25,
																	"block": {
																		"stmts": [
																			{
																				"type": "EqualStmt",
																				"stmt": {
																					"a": {
																						"type": "local",
																						"value": 24
																					},
																					"b": {
																						"type": "local",
																						"value": 5
																					},
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "NotStmt",
																				"stmt": {
																					"block": {
																						"stmts": [
																							{
																								"type": "DotStmt",
																								"stmt": {
																									"source": {
																										"type": "local",
																										"value": 20
																									},
																									"key": {
																										"type": "local",
																										"value": 24
																									},
																									"target": 26,
																									"file": 0,
																									"col": 6,
																									"row": 3
																								}
																							}
																						]
																					},
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "BlockStmt",
																				"stmt": {
																					"blocks": [
																						{
																							"stmts": [
																								{
																									"type": "BlockStmt",
																									"stmt": {
																										"blocks": [
																											{
																												"stmts": [
																													{
																														"type": "BreakStmt",
																														"stmt": {
																															"index": 1,
																															"file": 0,
																															"col": 6,
																															"row": 3
																														}
																													}
																												]
																											}
																										],
																										"file": 0,
																										"col": 6,
																										"row": 3
																									}
																								},
																								{
																									"type": "BreakStmt",
																									"stmt": {
																										"index": 1,
																										"file": 0,
																										"col": 6,
																										"row": 3
																									}
																								}
																							]
																						}
																					],
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "AssignVarStmt",
																				"stmt": {
																					"source": {
																						"type": "local",
																						"value": 25
																					},
																					"target": 29,
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "AssignVarOnceStmt",
																				"stmt": {
																					"source": {
																						"type": "local",
																						"value": 29
																					},
																					"target": 3,
																					"file": 0,
																					"col": 1,
																					"row": 3
																				}
																			}
																		]
																	},
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															}
														]
													},
													{
														"stmts": [
															{
																"type": "EqualStmt",
																"stmt": {
																	"a": {
																		"type": "string_index",
																		"value": 6
																	},
																	"b": {
																		"type": "local",
																		"value": 4
																	},
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "CallStmt",
																"stmt": {
																	"func": "g0.data.test.a.y",
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"result": 30,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 30
																	},
																	"key": {
																		"type": "local",
																		"value": 5
																	},
																	"target": 31,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "AssignVarStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 31
																	},
																	"target": 32,
																	"file": 0,
																	"col": 6,
																	"row": 3
																}
															},
															{
																"type": "AssignVarOnceStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 32
																	},
																	"target": 3,
																	"file": 0,
																	"col": 1,
																	"row": 3
																}
															}
														]
													}
												],
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 33,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "string_index",
													"value": 1
												},
												"set": 33,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "string_index",
													"value": 0
												},
												"set": 33,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "string_index",
													"value": 6
												},
												"set": 33,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "DotStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 1
												},
												"key": {
													"type": "string_index",
													"value": 3
												},
												"target": 34,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "DotStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 34
												},
												"key": {
													"type": "string_index",
													"value": 4
												},
												"target": 35,
												"file": 0,
												"col": 6,
												"row": 3
											}
										},
										{
											"type": "ScanStmt",
											"stmt": {
												"source": 35,
												"key": 36,
												"value": 37,
												"block": {
													"stmts": [
														{
															"type": "EqualStmt",
															"stmt": {
																"a": {
																	"type": "local",
																	"value": 36
																},
																"b": {
																	"type": "local",
																	"value": 4
																},
																"file": 0,
																"col": 6,
																"row": 3
															}
														},
														{
															"type": "NotStmt",
															"stmt": {
																"block": {
																	"stmts": [
																		{
																			"type": "DotStmt",
																			"stmt": {
																				"source": {
																					"type": "local",
																					"value": 33
																				},
																				"key": {
																					"type": "local",
																					"value": 36
																				},
																				"target": 38,
																				"file": 0,
																				"col": 6,
																				"row": 3
																			}
																		}
																	]
																},
																"file": 0,
																"col": 6,
																"row": 3
															}
														},
														{
															"type": "DotStmt",
															"stmt": {
																"source": {
																	"type": "local",
																	"value": 37
																},
																"key": {
																	"type": "local",
																	"value": 5
																},
																"target": 39,
																"file": 0,
																"col": 6,
																"row": 3
															}
														},
														{
															"type": "BlockStmt",
															"stmt": {
																"blocks": [
																	{
																		"stmts": [
																			{
																				"type": "BlockStmt",
																				"stmt": {
																					"blocks": [
																						{
																							"stmts": [
																								{
																									"type": "BreakStmt",
																									"stmt": {
																										"index": 1,
																										"file": 0,
																										"col": 6,
																										"row": 3
																									}
																								}
																							]
																						}
																					],
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			},
																			{
																				"type": "BreakStmt",
																				"stmt": {
																					"index": 1,
																					"file": 0,
																					"col": 6,
																					"row": 3
																				}
																			}
																		]
																	}
																],
																"file": 0,
																"col": 6,
																"row": 3
															}
														},
														{
															"type": "AssignVarStmt",
															"stmt": {
																"source": {
																	"type": "local",
																	"value": 39
																},
																"target": 42,
																"file": 0,
																"col": 6,
																"row": 3
															}
														},
														{
															"type": "AssignVarOnceStmt",
															"stmt": {
																"source": {
																	"type": "local",
																	"value": 42
																},
																"target": 3,
																"file": 0,
																"col": 1,
																"row": 3
															}
														}
													]
												},
												"file": 0,
												"col": 6,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		},
		{
			"note": "ir/call-dynamic with ref heads and unrelated rule (issue 7399)",
			"query": "data.test.p = x",
			"modules": [
				"package test\np := data[first].allow.see.something_else if first := \"primary\"\n",
				"package primary\nallow[action].something if  action := \"show\"\nallow.see.something_else if true\n",
				"package unrelated\nallow.other.stuff if true\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"ignore_generated_vars": false,
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "primary"
						},
						{
							"value": "g0"
						},
						{
							"value": "allow"
						},
						{
							"value": "show"
						},
						{
							"value": "something"
						},
						{
							"value": "see"
						},
						{
							"value": "something_else"
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "module-1.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 2,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 2,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 2,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 2,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 2,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.primary.allow",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 2,
												"file": 1,
												"col": 1,
												"row": 2
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 2
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 4
												},
												"target": 4,
												"file": 1,
												"col": 29,
												"row": 2
											}
										},
										{
											"type": "BlockStmt",
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"type": "BlockStmt",
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"type": "DotStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 2
																						},
																						"key": {
																							"type": "local",
																							"value": 4
																						},
																						"target": 5,
																						"file": 1,
																						"col": 1,
																						"row": 2
																					}
																				},
																				{
																					"type": "BreakStmt",
																					"stmt": {
																						"index": 1,
																						"file": 1,
																						"col": 1,
																						"row": 2
																					}
																				}
																			]
																		}
																	],
																	"file": 0,
																	"col": 0,
																	"row": 0
																}
															},
															{
																"type": "MakeObjectStmt",
																"stmt": {
																	"target": 5,
																	"file": 0,
																	"col": 0,
																	"row": 0
																}
															}
														]
													}
												],
												"file": 1,
												"col": 1,
												"row": 2
											}
										},
										{
											"type": "ObjectInsertOnceStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 5
												},
												"value": {
													"type": "bool",
													"value": true
												},
												"object": 5,
												"file": 1,
												"col": 1,
												"row": 2
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "local",
													"value": 4
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 2,
												"file": 1,
												"col": 1,
												"row": 2
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "BlockStmt",
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"type": "BlockStmt",
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"type": "DotStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 2
																						},
																						"key": {
																							"type": "string_index",
																							"value": 6
																						},
																						"target": 4,
																						"file": 1,
																						"col": 1,
																						"row": 3
																					}
																				},
																				{
																					"type": "BreakStmt",
																					"stmt": {
																						"index": 1,
																						"file": 1,
																						"col": 1,
																						"row": 3
																					}
																				}
																			]
																		}
																	],
																	"file": 0,
																	"col": 0,
																	"row": 0
																}
															},
															{
																"type": "MakeObjectStmt",
																"stmt": {
																	"target": 4,
																	"file": 0,
																	"col": 0,
																	"row": 0
																}
															}
														]
													}
												],
												"file": 1,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertOnceStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 7
												},
												"value": {
													"type": "bool",
													"value": true
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 6
												},
												"value": {
													"type": "local",
													"value": 4
												},
												"object": 2,
												"file": 1,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 1,
												"col": 1,
												"row": 2
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"primary",
								"allow"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 2
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 1
												},
												"target": 4,
												"file": 0,
												"col": 46,
												"row": 2
											}
										},
										{
											"type": "BlockStmt",
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"type": "BlockStmt",
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"type": "BlockStmt",
																					"stmt": {
																						"blocks": [
																							{
																								"stmts": [
																									{
																										"type": "CallDynamicStmt",
																										"stmt": {
																											"args": [
																												0,
																												1
																											],
																											"result": 5,
																											"path": [
																												{
																													"type": "string_index",
																													"value": 2
																												},
																												{
																													"type": "local",
																													"value": 4
																												},
																												{
																													"type": "string_index",
																													"value": 3
																												}
																											],
																											"file": 0,
																											"col": 6,
																											"row": 2
																										}
																									},
																									{
																										"type": "BreakStmt",
																										"stmt": {
																											"index": 1,
																											"file": 0,
																											"col": 6,
																											"row": 2
																										}
																									}
																								]
																							},
																							{
																								"stmts": [
																									{
																										"type": "DotStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 1
																											},
																											"key": {
																												"type": "local",
																												"value": 4
																											},
																											"target": 6,
																											"file": 0,
																											"col": 6,
																											"row": 2
																										}
																									},
																									{
																										"type": "DotStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 6
																											},
																											"key": {
																												"type": "string_index",
																												"value": 3
																											},
																											"target": 7,
																											"file": 0,
																											"col": 6,
																											"row": 2
																										}
																									},
																									{
																										"type": "AssignVarStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 7
																											},
																											"target": 5,
																											"file": 0,
																											"col": 6,
																											"row": 2
																										}
																									},
																									{
																										"type": "BreakStmt",
																										"stmt": {
																											"index": 1,
																											"file": 0,
																											"col": 6,
																											"row": 2
																										}
																									}
																								]
																							}
																						],
																						"file": 0,
																						"col": 0,
																						"row": 0
																					}
																				},
																				{
																					"type": "BreakStmt",
																					"stmt": {
																						"index": 2,
																						"file": 0,
																						"col": 0,
																						"row": 0
																					}
																				}
																			]
																		}
																	],
																	"file": 0,
																	"col": 0,
																	"row": 0
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 5
																	},
																	"key": {
																		"type": "string_index",
																		"value": 6
																	},
																	"target": 8,
																	"file": 0,
																	"col": 6,
																	"row": 2
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 8
																	},
																	"key": {
																		"type": "string_index",
																		"value": 7
																	},
																	"target": 9,
																	"file": 0,
																	"col": 6,
																	"row": 2
																}
															},
															{
																"type": "AssignVarStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 9
																	},
																	"target": 10,
																	"file": 0,
																	"col": 6,
																	"row": 2
																}
															},
															{
																"type": "AssignVarOnceStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 10
																	},
																	"target": 3,
																	"file": 0,
																	"col": 1,
																	"row": 2
																}
															}
														]
													}
												],
												"file": 0,
												"col": 6,
												"row": 2
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 2
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 2
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 2
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		},
		{
			"note": "ir/call-dynamic not used with ref heads and mixed-length rules (issue 7399)",
			"query": "data.test.q = x",
			"modules": [
				"package test\n\np.allow[action][resource] if { action := \"list\"; resource := \"fruit\" }\n\np.unrelated.eat.veggies if true\n\nq := p[input.rule][input.action][input.resource]\n"
			],
			"input": {
				"action": "list",
				"resource": "fruit",
				"rule": "allow"
			},
			"want_result": [
				{
					"x": true
				}
			],
			"ignore_generated_vars": false,
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "rule"
						},
						{
							"value": "action"
						},
						{
							"value": "resource"
						},
						{
							"value": "allow"
						},
						{
							"value": "list"
						},
						{
							"value": "fruit"
						},
						{
							"value": "unrelated"
						},
						{
							"value": "eat"
						},
						{
							"value": "veggies"
						},
						{
							"value": "test"
						},
						{
							"value": "p"
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.q",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.p.allow",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 5
												},
												"target": 4,
												"file": 0,
												"col": 32,
												"row": 3
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 6
												},
												"target": 5,
												"file": 0,
												"col": 50,
												"row": 3
											}
										},
										{
											"type": "BlockStmt",
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"type": "BlockStmt",
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"type": "DotStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 2
																						},
																						"key": {
																							"type": "local",
																							"value": 4
																						},
																						"target": 6,
																						"file": 0,
																						"col": 1,
																						"row": 3
																					}
																				},
																				{
																					"type": "BreakStmt",
																					"stmt": {
																						"index": 1,
																						"file": 0,
																						"col": 1,
																						"row": 3
																					}
																				}
																			]
																		}
																	],
																	"file": 0,
																	"col": 0,
																	"row": 0
																}
															},
															{
																"type": "MakeObjectStmt",
																"stmt": {
																	"target": 6,
																	"file": 0,
																	"col": 0,
																	"row": 0
																}
															}
														]
													}
												],
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertOnceStmt",
											"stmt": {
												"key": {
													"type": "local",
													"value": 5
												},
												"value": {
													"type": "bool",
													"value": true
												},
												"object": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "local",
													"value": 4
												},
												"value": {
													"type": "local",
													"value": 6
												},
												"object": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p",
								"allow"
							]
						},
						{
							"name": "g0.data.test.p.unrelated.eat.veggies",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p",
								"unrelated",
								"eat",
								"veggies"
							]
						},
						{
							"name": "g0.data.test.q",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "DotStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 0
												},
												"key": {
													"type": "string_index",
													"value": 1
												},
												"target": 4,
												"file": 0,
												"col": 8,
												"row": 7
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 5,
												"file": 0,
												"col": 8,
												"row": 7
											}
										},
										{
											"type": "DotStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 0
												},
												"key": {
													"type": "string_index",
													"value": 2
												},
												"target": 6,
												"file": 0,
												"col": 20,
												"row": 7
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7,
												"file": 0,
												"col": 20,
												"row": 7
											}
										},
										{
											"type": "DotStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 0
												},
												"key": {
													"type": "string_index",
													"value": 3
												},
												"target": 8,
												"file": 0,
												"col": 34,
												"row": 7
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 8
												},
												"target": 9,
												"file": 0,
												"col": 34,
												"row": 7
											}
										},
										{
											"type": "BlockStmt",
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"type": "EqualStmt",
																"stmt": {
																	"a": {
																		"type": "string_index",
																		"value": 4
																	},
																	"b": {
																		"type": "local",
																		"value": 5
																	},
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "CallStmt",
																"stmt": {
																	"func": "g0.data.test.p.allow",
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"result": 10,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 10
																	},
																	"key": {
																		"type": "local",
																		"value": 7
																	},
																	"target": 11,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 11
																	},
																	"key": {
																		"type": "local",
																		"value": 9
																	},
																	"target": 12,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "AssignVarStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 12
																	},
																	"target": 13,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "AssignVarOnceStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 13
																	},
																	"target": 3,
																	"file": 0,
																	"col": 1,
																	"row": 7
																}
															}
														]
													},
													{
														"stmts": [
															{
																"type": "EqualStmt",
																"stmt": {
																	"a": {
																		"type": "string_index",
																		"value": 7
																	},
																	"b": {
																		"type": "local",
																		"value": 5
																	},
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "BlockStmt",
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"type": "EqualStmt",
																					"stmt": {
																						"a": {
																							"type": "string_index",
																							"value": 8
																						},
																						"b": {
																							"type": "local",
																							"value": 7
																						},
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				},
																				{
																					"type": "BlockStmt",
																					"stmt": {
																						"blocks": [
																							{
																								"stmts": [
																									{
																										"type": "EqualStmt",
																										"stmt": {
																											"a": {
																												"type": "string_index",
																												"value": 9
																											},
																											"b": {
																												"type": "local",
																												"value": 9
																											},
																											"file": 0,
																											"col": 6,
																											"row": 7
																										}
																									},
																									{
																										"type": "CallStmt",
																										"stmt": {
																											"func": "g0.data.test.p.unrelated.eat.veggies",
																											"args": [
																												{
																													"type": "local",
																													"value": 0
																												},
																												{
																													"type": "local",
																													"value": 1
																												}
																											],
																											"result": 14,
																											"file": 0,
																											"col": 6,
																											"row": 7
																										}
																									},
																									{
																										"type": "AssignVarStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 14
																											},
																											"target": 15,
																											"file": 0,
																											"col": 6,
																											"row": 7
																										}
																									},
																									{
																										"type": "AssignVarOnceStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 15
																											},
																											"target": 3,
																											"file": 0,
																											"col": 1,
																											"row": 7
																										}
																									}
																								]
																							}
																						],
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				},
																				{
																					"type": "MakeSetStmt",
																					"stmt": {
																						"target": 16,
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				},
																				{
																					"type": "SetAddStmt",
																					"stmt": {
																						"value": {
																							"type": "string_index",
																							"value": 9
																						},
																						"set": 16,
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				},
																				{
																					"type": "DotStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"key": {
																							"type": "string_index",
																							"value": 10
																						},
																						"target": 17,
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				},
																				{
																					"type": "DotStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 17
																						},
																						"key": {
																							"type": "string_index",
																							"value": 11
																						},
																						"target": 18,
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				},
																				{
																					"type": "DotStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 18
																						},
																						"key": {
																							"type": "string_index",
																							"value": 7
																						},
																						"target": 19,
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				},
																				{
																					"type": "DotStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 19
																						},
																						"key": {
																							"type": "string_index",
																							"value": 8
																						},
																						"target": 20,
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				},
																				{
																					"type": "ScanStmt",
																					"stmt": {
																						"source": 20,
																						"key": 21,
																						"value": 22,
																						"block": {
																							"stmts": [
																								{
																									"type": "EqualStmt",
																									"stmt": {
																										"a": {
																											"type": "local",
																											"value": 21
																										},
																										"b": {
																											"type": "local",
																											"value": 9
																										},
																										"file": 0,
																										"col": 6,
																										"row": 7
																									}
																								},
																								{
																									"type": "NotStmt",
																									"stmt": {
																										"block": {
																											"stmts": [
																												{
																													"type": "DotStmt",
																													"stmt": {
																														"source": {
																															"type": "local",
																															"value": 16
																														},
																														"key": {
																															"type": "local",
																															"value": 21
																														},
																														"target": 23,
																														"file": 0,
																														"col": 6,
																														"row": 7
																													}
																												}
																											]
																										},
																										"file": 0,
																										"col": 6,
																										"row": 7
																									}
																								},
																								{
																									"type": "BlockStmt",
																									"stmt": {
																										"blocks": [
																											{
																												"stmts": [
																													{
																														"type": "BlockStmt",
																														"stmt": {
																															"blocks": [
																																{
																																	"stmts": [
																																		{
																																			"type": "BreakStmt",
																																			"stmt": {
																																				"index": 1,
																																				"file": 0,
																																				"col": 6,
																																				"row": 7
																																			}
																																		}
																																	]
																																}
																															],
																															"file": 0,
																															"col": 6,
																															"row": 7
																														}
																													},
																													{
																														"type": "BreakStmt",
																														"stmt": {
																															"index": 1,
																															"file": 0,
																															"col": 6,
																															"row": 7
																														}
																													}
																												]
																											}
																										],
																										"file": 0,
																										"col": 6,
																										"row": 7
																									}
																								},
																								{
																									"type": "AssignVarStmt",
																									"stmt": {
																										"source": {
																											"type": "local",
																											"value": 22
																										},
																										"target": 26,
																										"file": 0,
																										"col": 6,
																										"row": 7
																									}
																								},
																								{
																									"type": "AssignVarOnceStmt",
																									"stmt": {
																										"source": {
																											"type": "local",
																											"value": 26
																										},
																										"target": 3,
																										"file": 0,
																										"col": 1,
																										"row": 7
																									}
																								}
																							]
																						},
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				}
																			]
																		}
																	],
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "MakeSetStmt",
																"stmt": {
																	"target": 27,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "SetAddStmt",
																"stmt": {
																	"value": {
																		"type": "string_index",
																		"value": 8
																	},
																	"set": 27,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 1
																	},
																	"key": {
																		"type": "string_index",
																		"value": 10
																	},
																	"target": 28,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 28
																	},
																	"key": {
																		"type": "string_index",
																		"value": 11
																	},
																	"target": 29,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 29
																	},
																	"key": {
																		"type": "string_index",
																		"value": 7
																	},
																	"target": 30,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "ScanStmt",
																"stmt": {
																	"source": 30,
																	"key": 31,
																	"value": 32,
																	"block": {
																		"stmts": [
																			{
																				"type": "EqualStmt",
																				"stmt": {
																					"a": {
																						"type": "local",
																						"value": 31
																					},
																					"b": {
																						"type": "local",
																						"value": 7
																					},
																					"file": 0,
																					"col": 6,
																					"row": 7
																				}
																			},
																			{
																				"type": "NotStmt",
																				"stmt": {
																					"block": {
																						"stmts": [
																							{
																								"type": "DotStmt",
																								"stmt": {
																									"source": {
																										"type": "local",
																										"value": 27
																									},
																									"key": {
																										"type": "local",
																										"value": 31
																									},
																									"target": 33,
																									"file": 0,
																									"col": 6,
																									"row": 7
																								}
																							}
																						]
																					},
																					"file": 0,
																					"col": 6,
																					"row": 7
																				}
																			},
																			{
																				"type": "DotStmt",
																				"stmt": {
																					"source": {
																						"type": "local",
																						"value": 32
																					},
																					"key": {
																						"type": "local",
																						"value": 9
																					},
																					"target": 34,
																					"file": 0,
																					"col": 6,
																					"row": 7
																				}
																			},
																			{
																				"type": "BlockStmt",
																				"stmt": {
																					"blocks": [
																						{
																							"stmts": [
																								{
																									"type": "BlockStmt",
																									"stmt": {
																										"blocks": [
																											{
																												"stmts": [
																													{
																														"type": "BreakStmt",
																														"stmt": {
																															"index": 1,
																															"file": 0,
																															"col": 6,
																															"row": 7
																														}
																													}
																												]
																											}
																										],
																										"file": 0,
																										"col": 6,
																										"row": 7
																									}
																								},
																								{
																									"type": "BreakStmt",
																									"stmt": {
																										"index": 1,
																										"file": 0,
																										"col": 6,
																										"row": 7
																									}
																								}
																							]
																						}
																					],
																					"file": 0,
																					"col": 6,
																					"row": 7
																				}
																			},
																			{
																				"type": "AssignVarStmt",
																				"stmt": {
																					"source": {
																						"type": "local",
																						"value": 34
																					},
																					"target": 37,
																					"file": 0,
																					"col": 6,
																					"row": 7
																				}
																			},
																			{
																				"type": "AssignVarOnceStmt",
																				"stmt": {
																					"source": {
																						"type": "local",
																						"value": 37
																					},
																					"target": 3,
																					"file": 0,
																					"col": 1,
																					"row": 7
																				}
																			}
																		]
																	},
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															}
														]
													}
												],
												"file": 0,
												"col": 6,
												"row": 7
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 38,
												"file": 0,
												"col": 6,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "string_index",
													"value": 4
												},
												"set": 38,
												"file": 0,
												"col": 6,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "string_index",
													"value": 7
												},
												"set": 38,
												"file": 0,
												"col": 6,
												"row": 7
											}
										},
										{
											"type": "DotStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 1
												},
												"key": {
													"type": "string_index",
													"value": 10
												},
												"target": 39,
												"file": 0,
												"col": 6,
												"row": 7
											}
										},
										{
											"type": "DotStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 39
												},
												"key": {
													"type": "string_index",
													"value": 11
												},
												"target": 40,
												"file": 0,
												"col": 6,
												"row": 7
											}
										},
										{
											"type": "ScanStmt",
											"stmt": {
												"source": 40,
												"key": 41,
												"value": 42,
												"block": {
													"stmts": [
														{
															"type": "EqualStmt",
															"stmt": {
																"a": {
																	"type": "local",
																	"value": 41
																},
																"b": {
																	"type": "local",
																	"value": 5
																},
																"file": 0,
																"col": 6,
																"row": 7
															}
														},
														{
															"type": "NotStmt",
															"stmt": {
																"block": {
																	"stmts": [
																		{
																			"type": "DotStmt",
																			"stmt": {
																				"source": {
																					"type": "local",
																					"value": 38
																				},
																				"key": {
																					"type": "local",
																					"value": 41
																				},
																				"target": 43,
																				"file": 0,
																				"col": 6,
																				"row": 7
																			}
																		}
																	]
																},
																"file": 0,
																"col": 6,
																"row": 7
															}
														},
														{
															"type": "DotStmt",
															"stmt": {
																"source": {
																	"type": "local",
																	"value": 42
																},
																"key": {
																	"type": "local",
																	"value": 7
																},
																"target": 44,
																"file": 0,
																"col": 6,
																"row": 7
															}
														},
														{
															"type": "DotStmt",
															"stmt": {
																"source": {
																	"type": "local",
																	"value": 44
																},
																"key": {
																	"type": "local",
																	"value": 9
																},
																"target": 45,
																"file": 0,
																"col": 6,
																"row": 7
															}
														},
														{
															"type": "BlockStmt",
															"stmt": {
																"blocks": [
																	{
																		"stmts": [
																			{
																				"type": "BlockStmt",
																				"stmt": {
																					"blocks": [
																						{
																							"stmts": [
																								{
																									"type": "BreakStmt",
																									"stmt": {
																										"index": 1,
																										"file": 0,
																										"col": 6,
																										"row": 7
																									}
																								}
																							]
																						}
																					],
																					"file": 0,
																					"col": 6,
																					"row": 7
																				}
																			},
																			{
																				"type": "BreakStmt",
																				"stmt": {
																					"index": 1,
																					"file": 0,
																					"col": 6,
																					"row": 7
																				}
																			}
																		]
																	}
																],
																"file": 0,
																"col": 6,
																"row": 7
															}
														},
														{
															"type": "AssignVarStmt",
															"stmt": {
																"source": {
																	"type": "local",
																	"value": 45
																},
																"target": 48,
																"file": 0,
																"col": 6,
																"row": 7
															}
														},
														{
															"type": "AssignVarOnceStmt",
															"stmt": {
																"source": {
																	"type": "local",
																	"value": 48
																},
																"target": 3,
																"file": 0,
																"col": 1,
																"row": 7
															}
														}
													]
												},
												"file": 0,
												"col": 6,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"q"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		},
		{
			"note": "ir/call-dynamic not used with ref heads and mixed-length rules (issue 7399), second rule",
			"query": "data.test.q = x",
			"modules": [
				"package test\n\np.allow[action][resource] if { action := \"list\"; resource := \"fruit\" }\n\np.unrelated.eat.veggies if true\n\nq := p[input.rule][input.action][input.resource]\n"
			],
			"input": {
				"action": "eat",
				"resource": "veggies",
				"rule": "unrelated"
			},
			"want_result": [
				{
					"x": true
				}
			],
			"ignore_generated_vars": false,
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "rule"
						},
						{
							"value": "action"
						},
						{
							"value": "resource"
						},
						{
							"value": "allow"
						},
						{
							"value": "list"
						},
						{
							"value": "fruit"
						},
						{
							"value": "unrelated"
						},
						{
							"value": "eat"
						},
						{
							"value": "veggies"
						},
						{
							"value": "test"
						},
						{
							"value": "p"
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.q",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.p.allow",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 5
												},
												"target": 4,
												"file": 0,
												"col": 32,
												"row": 3
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "string_index",
													"value": 6
												},
												"target": 5,
												"file": 0,
												"col": 50,
												"row": 3
											}
										},
										{
											"type": "BlockStmt",
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"type": "BlockStmt",
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"type": "DotStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 2
																						},
																						"key": {
																							"type": "local",
																							"value": 4
																						},
																						"target": 6,
																						"file": 0,
																						"col": 1,
																						"row": 3
																					}
																				},
																				{
																					"type": "BreakStmt",
																					"stmt": {
																						"index": 1,
																						"file": 0,
																						"col": 1,
																						"row": 3
																					}
																				}
																			]
																		}
																	],
																	"file": 0,
																	"col": 0,
																	"row": 0
																}
															},
															{
																"type": "MakeObjectStmt",
																"stmt": {
																	"target": 6,
																	"file": 0,
																	"col": 0,
																	"row": 0
																}
															}
														]
													}
												],
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertOnceStmt",
											"stmt": {
												"key": {
													"type": "local",
													"value": 5
												},
												"value": {
													"type": "bool",
													"value": true
												},
												"object": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "local",
													"value": 4
												},
												"value": {
													"type": "local",
													"value": 6
												},
												"object": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p",
								"allow"
							]
						},
						{
							"name": "g0.data.test.p.unrelated.eat.veggies",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p",
								"unrelated",
								"eat",
								"veggies"
							]
						},
						{
							"name": "g0.data.test.q",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "DotStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 0
												},
												"key": {
													"type": "string_index",
													"value": 1
												},
												"target": 4,
												"file": 0,
												"col": 8,
												"row": 7
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 5,
												"file": 0,
												"col": 8,
												"row": 7
											}
										},
										{
											"type": "DotStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 0
												},
												"key": {
													"type": "string_index",
													"value": 2
												},
												"target": 6,
												"file": 0,
												"col": 20,
												"row": 7
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7,
												"file": 0,
												"col": 20,
												"row": 7
											}
										},
										{
											"type": "DotStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 0
												},
												"key": {
													"type": "string_index",
													"value": 3
												},
												"target": 8,
												"file": 0,
												"col": 34,
												"row": 7
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 8
												},
												"target": 9,
												"file": 0,
												"col": 34,
												"row": 7
											}
										},
										{
											"type": "BlockStmt",
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"type": "EqualStmt",
																"stmt": {
																	"a": {
																		"type": "string_index",
																		"value": 4
																	},
																	"b": {
																		"type": "local",
																		"value": 5
																	},
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "CallStmt",
																"stmt": {
																	"func": "g0.data.test.p.allow",
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"result": 10,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 10
																	},
																	"key": {
																		"type": "local",
																		"value": 7
																	},
																	"target": 11,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 11
																	},
																	"key": {
																		"type": "local",
																		"value": 9
																	},
																	"target": 12,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "AssignVarStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 12
																	},
																	"target": 13,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "AssignVarOnceStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 13
																	},
																	"target": 3,
																	"file": 0,
																	"col": 1,
																	"row": 7
																}
															}
														]
													},
													{
														"stmts": [
															{
																"type": "EqualStmt",
																"stmt": {
																	"a": {
																		"type": "string_index",
																		"value": 7
																	},
																	"b": {
																		"type": "local",
																		"value": 5
																	},
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "BlockStmt",
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"type": "EqualStmt",
																					"stmt": {
																						"a": {
																							"type": "string_index",
																							"value": 8
																						},
																						"b": {
																							"type": "local",
																							"value": 7
																						},
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				},
																				{
																					"type": "BlockStmt",
																					"stmt": {
																						"blocks": [
																							{
																								"stmts": [
																									{
																										"type": "EqualStmt",
																										"stmt": {
																											"a": {
																												"type": "string_index",
																												"value": 9
																											},
																											"b": {
																												"type": "local",
																												"value": 9
																											},
																											"file": 0,
																											"col": 6,
																											"row": 7
																										}
																									},
																									{
																										"type": "CallStmt",
																										"stmt": {
																											"func": "g0.data.test.p.unrelated.eat.veggies",
																											"args": [
																												{
																													"type": "local",
																													"value": 0
																												},
																												{
																													"type": "local",
																													"value": 1
																												}
																											],
																											"result": 14,
																											"file": 0,
																											"col": 6,
																											"row": 7
																										}
																									},
																									{
																										"type": "AssignVarStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 14
																											},
																											"target": 15,
																											"file": 0,
																											"col": 6,
																											"row": 7
																										}
																									},
																									{
																										"type": "AssignVarOnceStmt",
																										"stmt": {
																											"source": {
																												"type": "local",
																												"value": 15
																											},
																											"target": 3,
																											"file": 0,
																											"col": 1,
																											"row": 7
																										}
																									}
																								]
																							}
																						],
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				},
																				{
																					"type": "MakeSetStmt",
																					"stmt": {
																						"target": 16,
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				},
																				{
																					"type": "SetAddStmt",
																					"stmt": {
																						"value": {
																							"type": "string_index",
																							"value": 9
																						},
																						"set": 16,
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				},
																				{
																					"type": "DotStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"key": {
																							"type": "string_index",
																							"value": 10
																						},
																						"target": 17,
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				},
																				{
																					"type": "DotStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 17
																						},
																						"key": {
																							"type": "string_index",
																							"value": 11
																						},
																						"target": 18,
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				},
																				{
																					"type": "DotStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 18
																						},
																						"key": {
																							"type": "string_index",
																							"value": 7
																						},
																						"target": 19,
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				},
																				{
																					"type": "DotStmt",
																					"stmt": {
																						"source": {
																							"type": "local",
																							"value": 19
																						},
																						"key": {
																							"type": "string_index",
																							"value": 8
																						},
																						"target": 20,
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				},
																				{
																					"type": "ScanStmt",
																					"stmt": {
																						"source": 20,
																						"key": 21,
																						"value": 22,
																						"block": {
																							"stmts": [
																								{
																									"type": "EqualStmt",
																									"stmt": {
																										"a": {
																											"type": "local",
																											"value": 21
																										},
																										"b": {
																											"type": "local",
																											"value": 9
																										},
																										"file": 0,
																										"col": 6,
																										"row": 7
																									}
																								},
																								{
																									"type": "NotStmt",
																									"stmt": {
																										"block": {
																											"stmts": [
																												{
																													"type": "DotStmt",
																													"stmt": {
																														"source": {
																															"type": "local",
																															"value": 16
																														},
																														"key": {
																															"type": "local",
																															"value": 21
																														},
																														"target": 23,
																														"file": 0,
																														"col": 6,
																														"row": 7
																													}
																												}
																											]
																										},
																										"file": 0,
																										"col": 6,
																										"row": 7
																									}
																								},
																								{
																									"type": "BlockStmt",
																									"stmt": {
																										"blocks": [
																											{
																												"stmts": [
																													{
																														"type": "BlockStmt",
																														"stmt": {
																															"blocks": [
																																{
																																	"stmts": [
																																		{
																																			"type": "BreakStmt",
																																			"stmt": {
																																				"index": 1,
																																				"file": 0,
																																				"col": 6,
																																				"row": 7
																																			}
																																		}
																																	]
																																}
																															],
																															"file": 0,
																															"col": 6,
																															"row": 7
																														}
																													},
																													{
																														"type": "BreakStmt",
																														"stmt": {
																															"index": 1,
																															"file": 0,
																															"col": 6,
																															"row": 7
																														}
																													}
																												]
																											}
																										],
																										"file": 0,
																										"col": 6,
																										"row": 7
																									}
																								},
																								{
																									"type": "AssignVarStmt",
																									"stmt": {
																										"source": {
																											"type": "local",
																											"value": 22
																										},
																										"target": 26,
																										"file": 0,
																										"col": 6,
																										"row": 7
																									}
																								},
																								{
																									"type": "AssignVarOnceStmt",
																									"stmt": {
																										"source": {
																											"type": "local",
																											"value": 26
																										},
																										"target": 3,
																										"file": 0,
																										"col": 1,
																										"row": 7
																									}
																								}
																							]
																						},
																						"file": 0,
																						"col": 6,
																						"row": 7
																					}
																				}
																			]
																		}
																	],
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "MakeSetStmt",
																"stmt": {
																	"target": 27,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "SetAddStmt",
																"stmt": {
																	"value": {
																		"type": "string_index",
																		"value": 8
																	},
																	"set": 27,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 1
																	},
																	"key": {
																		"type": "string_index",
																		"value": 10
																	},
																	"target": 28,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 28
																	},
																	"key": {
																		"type": "string_index",
																		"value": 11
																	},
																	"target": 29,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "DotStmt",
																"stmt": {
																	"source": {
																		"type": "local",
																		"value": 29
																	},
																	"key": {
																		"type": "string_index",
																		"value": 7
																	},
																	"target": 30,
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															},
															{
																"type": "ScanStmt",
																"stmt": {
																	"source": 30,
																	"key": 31,
																	"value": 32,
																	"block": {
																		"stmts": [
																			{
																				"type": "EqualStmt",
																				"stmt": {
																					"a": {
																						"type": "local",
																						"value": 31
																					},
																					"b": {
																						"type": "local",
																						"value": 7
																					},
																					"file": 0,
																					"col": 6,
																					"row": 7
																				}
																			},
																			{
																				"type": "NotStmt",
																				"stmt": {
																					"block": {
																						"stmts": [
																							{
																								"type": "DotStmt",
																								"stmt": {
																									"source": {
																										"type": "local",
																										"value": 27
																									},
																									"key": {
																										"type": "local",
																										"value": 31
																									},
																									"target": 33,
																									"file": 0,
																									"col": 6,
																									"row": 7
																								}
																							}
																						]
																					},
																					"file": 0,
																					"col": 6,
																					"row": 7
																				}
																			},
																			{
																				"type": "DotStmt",
																				"stmt": {
																					"source": {
																						"type": "local",
																						"value": 32
																					},
																					"key": {
																						"type": "local",
																						"value": 9
																					},
																					"target": 34,
																					"file": 0,
																					"col": 6,
																					"row": 7
																				}
																			},
																			{
																				"type": "BlockStmt",
																				"stmt": {
																					"blocks": [
																						{
																							"stmts": [
																								{
																									"type": "BlockStmt",
																									"stmt": {
																										"blocks": [
																											{
																												"stmts": [
																													{
																														"type": "BreakStmt",
																														"stmt": {
																															"index": 1,
																															"file": 0,
																															"col": 6,
																															"row": 7
																														}
																													}
																												]
																											}
																										],
																										"file": 0,
																										"col": 6,
																										"row": 7
																									}
																								},
																								{
																									"type": "BreakStmt",
																									"stmt": {
																										"index": 1,
																										"file": 0,
																										"col": 6,
																										"row": 7
																									}
																								}
																							]
																						}
																					],
																					"file": 0,
																					"col": 6,
																					"row": 7
																				}
																			},
																			{
																				"type": "AssignVarStmt",
																				"stmt": {
																					"source": {
																						"type": "local",
																						"value": 34
																					},
																					"target": 37,
																					"file": 0,
																					"col": 6,
																					"row": 7
																				}
																			},
																			{
																				"type": "AssignVarOnceStmt",
																				"stmt": {
																					"source": {
																						"type": "local",
																						"value": 37
																					},
																					"target": 3,
																					"file": 0,
																					"col": 1,
																					"row": 7
																				}
																			}
																		]
																	},
																	"file": 0,
																	"col": 6,
																	"row": 7
																}
															}
														]
													}
												],
												"file": 0,
												"col": 6,
												"row": 7
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 38,
												"file": 0,
												"col": 6,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "string_index",
													"value": 4
												},
												"set": 38,
												"file": 0,
												"col": 6,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "string_index",
													"value": 7
												},
												"set": 38,
												"file": 0,
												"col": 6,
												"row": 7
											}
										},
										{
											"type": "DotStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 1
												},
												"key": {
													"type": "string_index",
													"value": 10
												},
												"target": 39,
												"file": 0,
												"col": 6,
												"row": 7
											}
										},
										{
											"type": "DotStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 39
												},
												"key": {
													"type": "string_index",
													"value": 11
												},
												"target": 40,
												"file": 0,
												"col": 6,
												"row": 7
											}
										},
										{
											"type": "ScanStmt",
											"stmt": {
												"source": 40,
												"key": 41,
												"value": 42,
												"block": {
													"stmts": [
														{
															"type": "EqualStmt",
															"stmt": {
																"a": {
																	"type": "local",
																	"value": 41
																},
																"b": {
																	"type": "local",
																	"value": 5
																},
																"file": 0,
																"col": 6,
																"row": 7
															}
														},
														{
															"type": "NotStmt",
															"stmt": {
																"block": {
																	"stmts": [
																		{
																			"type": "DotStmt",
																			"stmt": {
																				"source": {
																					"type": "local",
																					"value": 38
																				},
																				"key": {
																					"type": "local",
																					"value": 41
																				},
																				"target": 43,
																				"file": 0,
																				"col": 6,
																				"row": 7
																			}
																		}
																	]
																},
																"file": 0,
																"col": 6,
																"row": 7
															}
														},
														{
															"type": "DotStmt",
															"stmt": {
																"source": {
																	"type": "local",
																	"value": 42
																},
																"key": {
																	"type": "local",
																	"value": 7
																},
																"target": 44,
																"file": 0,
																"col": 6,
																"row": 7
															}
														},
														{
															"type": "DotStmt",
															"stmt": {
																"source": {
																	"type": "local",
																	"value": 44
																},
																"key": {
																	"type": "local",
																	"value": 9
																},
																"target": 45,
																"file": 0,
																"col": 6,
																"row": 7
															}
														},
														{
															"type": "BlockStmt",
															"stmt": {
																"blocks": [
																	{
																		"stmts": [
																			{
																				"type": "BlockStmt",
																				"stmt": {
																					"blocks": [
																						{
																							"stmts": [
																								{
																									"type": "BreakStmt",
																									"stmt": {
																										"index": 1,
																										"file": 0,
																										"col": 6,
																										"row": 7
																									}
																								}
																							]
																						}
																					],
																					"file": 0,
																					"col": 6,
																					"row": 7
																				}
																			},
																			{
																				"type": "BreakStmt",
																				"stmt": {
																					"index": 1,
																					"file": 0,
																					"col": 6,
																					"row": 7
																				}
																			}
																		]
																	}
																],
																"file": 0,
																"col": 6,
																"row": 7
															}
														},
														{
															"type": "AssignVarStmt",
															"stmt": {
																"source": {
																	"type": "local",
																	"value": 45
																},
																"target": 48,
																"file": 0,
																"col": 6,
																"row": 7
															}
														},
														{
															"type": "AssignVarOnceStmt",
															"stmt": {
																"source": {
																	"type": "local",
																	"value": 48
																},
																"target": 3,
																"file": 0,
																"col": 1,
																"row": 7
															}
														}
													]
												},
												"file": 0,
												"col": 6,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"q"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		}
	]
}